{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Krishna/Project/Syntorion/Vyapar-Sarthi-AI/frontend/lib/actions.ts"],"sourcesContent":["'use server';\r\n\r\nimport { z } from 'zod';\r\n\r\nconst commandSchema = z.string().min(1, { message: 'Command cannot be empty.' });\r\n\r\ntype VoiceCommandResult =\r\n  | { type: 'ADD_STOCK'; data: any }\r\n  | { type: 'RECORD_SALE'; data: any }\r\n  | { type: 'ADD_CREDIT'; data: any }\r\n  | { type: 'CHECK_BALANCE'; data: any }\r\n  | { error: string; details?: string };\r\n\r\nexport async function handleVoiceCommand(command: string): Promise<VoiceCommandResult> {\r\n  const validation = commandSchema.safeParse(command);\r\n  if (!validation.success) return { error: 'Invalid command' };\r\n\r\n  const backendUrl = process.env.NEXT_PUBLIC_BACKEND_URL || process.env.BACKEND_URL || 'http://localhost:4000';\r\n  try {\r\n    const res = await fetch(`${backendUrl}/api/voice/parse`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ command }),\r\n      cache: 'no-store',\r\n    });\r\n    const json = await res.json();\r\n    if (!res.ok) return { error: json?.error || 'Backend error', details: json?.details };\r\n    return json as VoiceCommandResult;\r\n  } catch (e: any) {\r\n    return { error: 'Backend unreachable', details: e?.message };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;IAasB,qBAAA,WAAA,GAAA,CAAA,GAAA,yNAAA,CAAA,wBAAA,EAAA,8CAAA,yNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,yNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 43, "column": 0}, "map": {"version":3,"sources":["file:///C:/Krishna/Project/Syntorion/Vyapar-Sarthi-AI/frontend/app/page.tsx"],"sourcesContent":["'use client';\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { handleChatMessage } from '@/lib/actions';\r\n\r\n\r\n// --- Helper Components ---\r\n\r\n\r\n// Header Component\r\nconst Header = () => (\r\n   <header className=\"bg-card shadow-md w-full max-w-md mx-auto p-4 fixed top-0 left-0 right-0 z-10 rounded-b-lg\">\r\n       <h1 className=\"text-2xl font-bold text-center text-card-foreground\">\r\n           Vyapar Sarthi ðŸš€\r\n       </h1>\r\n       <p className=\"text-center text-sm text-muted-foreground\">Your Business Charioteer</p>\r\n   </header>\r\n);\r\n\r\n\r\n// Message Bubble Component\r\nconst MessageBubble = ({ message }: { message: { text: string; sender: string; timestamp: string } }) => {\r\n   const { text, sender, timestamp } = message;\r\n   const isUser = sender === 'user';\r\n\r\n\r\n   return (\r\n       <div className={`flex ${isUser ? 'justify-end' : 'justify-start'} mb-4`}>\r\n           <div\r\n               className={`max-w-xs md:max-w-md px-4 py-3 rounded-2xl ${\r\n                   isUser\r\n                       ? 'bg-primary text-primary-foreground rounded-br-none'\r\n                       : 'bg-muted text-muted-foreground rounded-bl-none'\r\n               }`}\r\n           >\r\n               <p className={`text-base ${isUser ? 'text-right' : 'text-left'}`}>{text}</p>\r\n               <p className=\"text-xs text-right mt-1 opacity-70\">{timestamp}</p>\r\n           </div>\r\n       </div>\r\n   );\r\n};\r\n\r\n\r\n// --- Main App Component ---\r\n\r\n\r\nexport default function App() {\r\n    const [clientLoaded, setClientLoaded] = useState(false);\r\n    useEffect(() => {\r\n        setClientLoaded(true);\r\n    }, []);\r\n\r\n   // State for managing conversation messages\r\n   const [messages, setMessages] = useState([\r\n       {\r\n           id: 1,\r\n           text: \"Welcome to Vyapar Sarthi! How can I help you today? Try saying: '10 Parle-G biscuit stock mein add karo'\",\r\n           sender: 'assistant',\r\n           timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\r\n       },\r\n   ]);\r\n\r\n\r\n   // State for the text input field\r\n   const [inputText, setInputText] = useState('');\r\n   // State to simulate recording state\r\n   const [isRecording, setIsRecording] = useState(false);\r\n   const [isLoading, setIsLoading] = useState(false);\r\n  \r\n   const conversationEndRef = useRef<HTMLDivElement>(null);\r\n\r\n\r\n   // Effect to scroll to the bottom of the conversation\r\n   useEffect(() => {\r\n       conversationEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n   }, [messages]);\r\n\r\n\r\n   // Function to add a new message to the conversation\r\n   const addMessage = (text: string, sender: 'user' | 'assistant') => {\r\n       const newMessage = {\r\n           id: messages.length + 1,\r\n           text,\r\n           sender,\r\n           timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\r\n       };\r\n       setMessages(prevMessages => [...prevMessages, newMessage]);\r\n       return newMessage;\r\n   };\r\n\r\n   // Function to handle backend processing and assistant reply\r\n   const processUserMessage = async (text: string) => {\r\n        setIsLoading(true);\r\n        const result = await handleChatMessage(text);\r\n        \r\n        let replyText = \"\";\r\n        if (result.error) {\r\n            replyText = `Sorry, I encountered an error: ${result.details || result.error}`;\r\n        } else {\r\n            switch(result.type) {\r\n                case 'ADD_STOCK':\r\n                    replyText = `Added ${result.data.quantity} of ${result.data.product_name} to stock.`;\r\n                    break;\r\n                case 'RECORD_SALE':\r\n                    replyText = `Recorded sale of ${result.data.entities.quantity} ${result.data.entities.product_name}.`;\r\n                    break;\r\n                case 'ADD_CREDIT':\r\n                    replyText = `Added credit of â‚¹${result.data.entities.amount} for ${result.data.entities.customer_name}.`;\r\n                    break;\r\n                case 'CHECK_BALANCE':\r\n                     replyText = `Checking balance for ${result.data.entities.customer_name}.`;\r\n                    break;\r\n                default:\r\n                    replyText = \"I've processed your request.\";\r\n            }\r\n        }\r\n        \r\n        addMessage(replyText, 'assistant');\r\n        setIsLoading(false);\r\n   }\r\n\r\n   // Handler for sending a text message\r\n   const handleSendMessage = async () => {\r\n       if (inputText.trim()) {\r\n           addMessage(inputText, 'user');\r\n           await processUserMessage(inputText);\r\n           setInputText('');\r\n       }\r\n   };\r\n\r\n   // Handler for the microphone button press\r\n   const handleMicPress = () => {\r\n       setIsRecording(true);\r\n       // This is where you would start the actual speech recognition.\r\n       // We will simulate a voice command after a delay.\r\n       setTimeout(() => {\r\n           setIsRecording(false);\r\n           const voiceCommands = [\r\n               \"20kg aashirvaad atta purchase mein daalo\",\r\n               \"Raju ko 50 rupaye udhaar diye\",\r\n               \"Aaj ka sales report dikhao\",\r\n               \"5 Dairy Milk Silk expire hone wali hai\"\r\n           ];\r\n           const randomCommand = voiceCommands[Math.floor(Math.random() * voiceCommands.length)];\r\n           addMessage(randomCommand, 'user');\r\n           processUserMessage(randomCommand);\r\n       }, 2500); // Simulate a 2.5 second recording\r\n   };\r\n  \r\n   // Handler for key press in input field\r\n   const handleKeyPress = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n       if (e.key === 'Enter') {\r\n           handleSendMessage();\r\n       }\r\n   };\r\n   \r\n    if (!clientLoaded) {\r\n        return null; // Or a loading spinner\r\n    }\r\n\r\n\r\n   return (\r\n       <div className=\"bg-background font-sans h-screen flex flex-col items-center\">\r\n           <Header />\r\n          \r\n           {/* Conversation Area */}\r\n           <main className=\"flex-1 w-full max-w-md mx-auto pt-24 pb-28 px-4 overflow-y-auto\">\r\n               <div className=\"flex flex-col space-y-4\">\r\n                   {messages.map(msg => (\r\n                       <MessageBubble key={msg.id} message={msg} />\r\n                   ))}\r\n                    {isLoading && (\r\n                        <MessageBubble message={{ text: \"...\", sender: 'assistant', timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) }} />\r\n                    )}\r\n                   <div ref={conversationEndRef} />\r\n               </div>\r\n           </main>\r\n\r\n\r\n           {/* Input Bar */}\r\n           <footer className=\"bg-card shadow-t-md w-full max-w-md mx-auto p-4 fixed bottom-0 left-0 right-0 z-10 rounded-t-lg\">\r\n               <div className=\"flex items-center space-x-3\">\r\n                   <input\r\n                       type=\"text\"\r\n                       value={inputText}\r\n                       onChange={(e) => setInputText(e.target.value)}\r\n                       onKeyPress={handleKeyPress}\r\n                       placeholder=\"Or type your command...\"\r\n                       className=\"flex-1 p-3 border border-border rounded-full focus:outline-none focus:ring-2 focus:ring-ring transition\"\r\n                       disabled={isLoading || isRecording}\r\n                   />\r\n                   {isRecording ? (\r\n                       <div className=\"flex items-center justify-center bg-red-500 text-white w-16 h-16 rounded-full transition-all duration-300 ease-in-out\">\r\n                            <svg className=\"w-8 h-8 animate-pulse\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z\"></path><path fillRule=\"evenodd\" d=\"M5.5 10.5a.5.5 0 01.5.5v1a4 4 0 004 4h.5a.5.5 0 010 1h-.5a5 5 0 01-5-5v-1a.5.5 0 01.5-.5z\" clipRule=\"evenodd\"></path></svg>\r\n                            <span className=\"absolute text-xs font-bold\">Listening...</span>\r\n                       </div>\r\n                   ) : (\r\n                       <button\r\n                           onClick={handleMicPress}\r\n                           disabled={isLoading}\r\n                           className=\"bg-primary hover:bg-primary/90 text-primary-foreground w-16 h-16 rounded-full flex items-center justify-center shadow-lg transform hover:scale-105 transition-all duration-300 ease-in-out disabled:opacity-50 disabled:scale-100\"\r\n                       >\r\n                           {/* Microphone Icon */}\r\n                           <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\"></path></svg>\r\n                       </button>\r\n                   )}\r\n               </div>\r\n           </footer>\r\n       </div>\r\n   );\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;;;AAFA;;;AAKA,4BAA4B;AAG5B,mBAAmB;AACnB,MAAM,SAAS,kBACZ,6LAAC;QAAO,WAAU;;0BACd,6LAAC;gBAAG,WAAU;0BAAsD;;;;;;0BAGpE,6LAAC;gBAAE,WAAU;0BAA4C;;;;;;;;;;;;KAL1D;AAUN,2BAA2B;AAC3B,MAAM,gBAAgB,CAAC,EAAE,OAAO,EAAoE;IACjG,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG;IACpC,MAAM,SAAS,WAAW;IAG1B,qBACI,6LAAC;QAAI,WAAW,CAAC,KAAK,EAAE,SAAS,gBAAgB,gBAAgB,KAAK,CAAC;kBACnE,cAAA,6LAAC;YACG,WAAW,CAAC,2CAA2C,EACnD,SACM,uDACA,kDACR;;8BAEF,6LAAC;oBAAE,WAAW,CAAC,UAAU,EAAE,SAAS,eAAe,aAAa;8BAAG;;;;;;8BACnE,6LAAC;oBAAE,WAAU;8BAAsC;;;;;;;;;;;;;;;;;AAIlE;MAnBM;AAyBS,SAAS;;IACpB,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;yBAAE;YACN,gBAAgB;QACpB;wBAAG,EAAE;IAEN,2CAA2C;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;QACrC;YACI,IAAI;YACJ,MAAM;YACN,QAAQ;YACR,WAAW,IAAI,OAAO,kBAAkB,CAAC,EAAE,EAAE;gBAAE,MAAM;gBAAW,QAAQ;YAAU;QACtF;KACH;IAGD,iCAAiC;IACjC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,oCAAoC;IACpC,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE3C,MAAM,qBAAqB,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAkB;IAGlD,qDAAqD;IACrD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;yBAAE;YACN,mBAAmB,OAAO,EAAE,eAAe;gBAAE,UAAU;YAAS;QACpE;wBAAG;QAAC;KAAS;IAGb,oDAAoD;IACpD,MAAM,aAAa,CAAC,MAAc;QAC9B,MAAM,aAAa;YACf,IAAI,SAAS,MAAM,GAAG;YACtB;YACA;YACA,WAAW,IAAI,OAAO,kBAAkB,CAAC,EAAE,EAAE;gBAAE,MAAM;gBAAW,QAAQ;YAAU;QACtF;QACA,YAAY,CAAA,eAAgB;mBAAI;gBAAc;aAAW;QACzD,OAAO;IACX;IAEA,4DAA4D;IAC5D,MAAM,qBAAqB,OAAO;QAC7B,aAAa;QACb,MAAM,SAAS,MAAM,CAAA,GAAA,kIAAA,CAAA,oBAAiB,AAAD,EAAE;QAEvC,IAAI,YAAY;QAChB,IAAI,OAAO,KAAK,EAAE;YACd,YAAY,CAAC,+BAA+B,EAAE,OAAO,OAAO,IAAI,OAAO,KAAK,EAAE;QAClF,OAAO;YACH,OAAO,OAAO,IAAI;gBACd,KAAK;oBACD,YAAY,CAAC,MAAM,EAAE,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC;oBACpF;gBACJ,KAAK;oBACD,YAAY,CAAC,iBAAiB,EAAE,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,EAAE,OAAO,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;oBACrG;gBACJ,KAAK;oBACD,YAAY,CAAC,iBAAiB,EAAE,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;oBACxG;gBACJ,KAAK;oBACA,YAAY,CAAC,qBAAqB,EAAE,OAAO,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;oBAC1E;gBACJ;oBACI,YAAY;YACpB;QACJ;QAEA,WAAW,WAAW;QACtB,aAAa;IAClB;IAEA,qCAAqC;IACrC,MAAM,oBAAoB;QACtB,IAAI,UAAU,IAAI,IAAI;YAClB,WAAW,WAAW;YACtB,MAAM,mBAAmB;YACzB,aAAa;QACjB;IACJ;IAEA,0CAA0C;IAC1C,MAAM,iBAAiB;QACnB,eAAe;QACf,+DAA+D;QAC/D,kDAAkD;QAClD,WAAW;YACP,eAAe;YACf,MAAM,gBAAgB;gBAClB;gBACA;gBACA;gBACA;aACH;YACD,MAAM,gBAAgB,aAAa,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,cAAc,MAAM,EAAE;YACrF,WAAW,eAAe;YAC1B,mBAAmB;QACvB,GAAG,OAAO,kCAAkC;IAChD;IAEA,uCAAuC;IACvC,MAAM,iBAAiB,CAAC;QACpB,IAAI,EAAE,GAAG,KAAK,SAAS;YACnB;QACJ;IACJ;IAEC,IAAI,CAAC,cAAc;QACf,OAAO,MAAM,uBAAuB;IACxC;IAGD,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;;;;;0BAGD,6LAAC;gBAAK,WAAU;0BACZ,cAAA,6LAAC;oBAAI,WAAU;;wBACV,SAAS,GAAG,CAAC,CAAA,oBACV,6LAAC;gCAA2B,SAAS;+BAAjB,IAAI,EAAE;;;;;wBAE5B,2BACG,6LAAC;4BAAc,SAAS;gCAAE,MAAM;gCAAO,QAAQ;gCAAa,WAAW,IAAI,OAAO,kBAAkB,CAAC,EAAE,EAAE;oCAAE,MAAM;oCAAW,QAAQ;gCAAU;4BAAG;;;;;;sCAEtJ,6LAAC;4BAAI,KAAK;;;;;;;;;;;;;;;;;0BAMlB,6LAAC;gBAAO,WAAU;0BACd,cAAA,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BACG,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;4BAC5C,YAAY;4BACZ,aAAY;4BACZ,WAAU;4BACV,UAAU,aAAa;;;;;;wBAE1B,4BACG,6LAAC;4BAAI,WAAU;;8CACV,6LAAC;oCAAI,WAAU;oCAAwB,MAAK;oCAAe,SAAQ;;sDAAY,6LAAC;4CAAK,GAAE;;;;;;sDAA4C,6LAAC;4CAAK,UAAS;4CAAU,GAAE;4CAA4F,UAAS;;;;;;;;;;;;8CACnQ,6LAAC;oCAAK,WAAU;8CAA6B;;;;;;;;;;;iDAGlD,6LAAC;4BACG,SAAS;4BACT,UAAU;4BACV,WAAU;sCAGV,cAAA,6LAAC;gCAAI,WAAU;gCAAU,MAAK;gCAAO,QAAO;gCAAe,SAAQ;gCAAY,OAAM;0CAA6B,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAY;oCAAI,GAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOlN;GApKwB;MAAA","debugId":null}},
    {"offset": {"line": 411, "column": 0}, "map": {"version":3,"sources":["file:///C:/Krishna/Project/Syntorion/Vyapar-Sarthi-AI/frontend/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-client-wrapper.ts"],"sourcesContent":["// This file must be bundled in the app's client layer, it shouldn't be directly\n// imported by the server.\n\nexport { callServer } from 'next/dist/client/app-call-server'\nexport { findSourceMapURL } from 'next/dist/client/app-find-source-map-url'\n\n// A noop wrapper to let the Flight client create the server reference.\n// See also: https://github.com/facebook/react/pull/26632\n// Since we're using the Edge build of Flight client for SSR [1], here we need to\n// also use the same Edge build to create the reference. For the client bundle,\n// we use the default and let Webpack to resolve it to the correct version.\n// 1: https://github.com/vercel/next.js/blob/16eb80b0b0be13f04a6407943664b5efd8f3d7d0/packages/next/src/server/app-render/use-flight-response.tsx#L24-L26\nexport const createServerReference = (\n  (!!process.env.NEXT_RUNTIME\n    ? // eslint-disable-next-line import/no-extraneous-dependencies\n      require('react-server-dom-webpack/client.edge')\n    : // eslint-disable-next-line import/no-extraneous-dependencies\n      require('react-server-dom-webpack/client')) as typeof import('react-server-dom-webpack/client')\n).createServerReference\n"],"names":["callServer","createServerReference","findSourceMapURL","process","env","NEXT_RUNTIME","require"],"mappings":"AAAA,gFAAgF;AAChF,0BAA0B;AAYrBG,QAAQC,GAAG,CAACC,YAAY,GAEvBC,QAAQ,0CAERA,QAAQ;;;;;;;;;;;;;;;;;IAdLN,UAAU,EAAA;eAAVA,eAAAA,UAAU;;IASNC,qBAAqB,EAAA;eAArBA;;IARJC,gBAAgB,EAAA;eAAhBA,qBAAAA,gBAAgB;;;+BADE;qCACM;AAQ1B,MAAMD,wBACV,CAAA,CAAC,+MAI2C,EAC7CA,qBAAqB","ignoreList":[0],"debugId":null}}]
}