{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///workspace/frontend/src/lib/client.ts"],"sourcesContent":["'use client';\n\nimport { z } from 'zod';\n\nconst commandSchema = z.string().min(1, { message: 'Command cannot be empty.' });\n\ntype VoiceCommandResult =\n  | { type: 'ADD_STOCK'; data: any }\n  | { type: 'RECORD_SALE'; data: any }\n  | { type: 'ADD_CREDIT'; data: any }\n  | { type: 'CHECK_BALANCE'; data: any }\n  | { error: string; details?: string };\n\nexport async function handleVoiceCommand(command: string): Promise<VoiceCommandResult> {\n  const validation = commandSchema.safeParse(command);\n  if (!validation.success) return { error: 'Invalid command' };\n  try {\n    const res = await fetch('/api/voice/parse', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ command }),\n      cache: 'no-store',\n    });\n    const json = await res.json();\n    if (!res.ok) return { error: json?.error || 'Backend error', details: json?.details };\n    return json as VoiceCommandResult;\n  } catch (e: any) {\n    return { error: 'Frontend API unreachable', details: e?.message };\n  }\n}"],"names":[],"mappings":";;;AAEA;AAFA;;AAIA,MAAM,gBAAgB,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAAE,SAAS;AAA2B;AASvE,eAAe,mBAAmB,OAAe;IACtD,MAAM,aAAa,cAAc,SAAS,CAAC;IAC3C,IAAI,CAAC,WAAW,OAAO,EAAE,OAAO;QAAE,OAAO;IAAkB;IAC3D,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,oBAAoB;YAC1C,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAQ;YAC/B,OAAO;QACT;QACA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;YAAE,OAAO,MAAM,SAAS;YAAiB,SAAS,MAAM;QAAQ;QACpF,OAAO;IACT,EAAE,OAAO,GAAQ;QACf,OAAO;YAAE,OAAO;YAA4B,SAAS,GAAG;QAAQ;IAClE;AACF","debugId":null}},
    {"offset": {"line": 51, "column": 0}, "map": {"version":3,"sources":["file:///workspace/frontend/src/app/page.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useRef, useEffect } from 'react';\nimport { handleVoiceCommand } from '@/lib/client';\n\n\n// --- Helper Components ---\n\n\n// Header Component\nconst Header = () => (\n   <header className=\"bg-card shadow-md w-full max-w-md mx-auto p-4 fixed top-0 left-0 right-0 z-10 rounded-b-lg\">\n       <h1 className=\"text-2xl font-bold text-center text-card-foreground\">\n           Vyapar Sarthi ðŸš€\n       </h1>\n       <p className=\"text-center text-sm text-muted-foreground\">Your Business Charioteer</p>\n   </header>\n);\n\n\n// Message Bubble Component\nconst MessageBubble = ({ message }: { message: { text: string; sender: string; timestamp: string } }) => {\n   const { text, sender, timestamp } = message;\n   const isUser = sender === 'user';\n\n\n   return (\n       <div className={`flex ${isUser ? 'justify-end' : 'justify-start'} mb-4`}>\n           <div\n               className={`max-w-xs md:max-w-md px-4 py-3 rounded-2xl ${\n                   isUser\n                       ? 'bg-primary text-primary-foreground rounded-br-none'\n                       : 'bg-muted text-muted-foreground rounded-bl-none'\n               }`}\n           >\n               <p className={`text-base ${isUser ? 'text-right' : 'text-left'}`}>{text}</p>\n               <p className=\"text-xs text-right mt-1 opacity-70\">{timestamp}</p>\n           </div>\n       </div>\n   );\n};\n\n\n// --- Main App Component ---\n\n\nexport default function App() {\n    const [clientLoaded, setClientLoaded] = useState(false);\n    useEffect(() => {\n        setClientLoaded(true);\n    }, []);\n\n   // State for managing conversation messages\n   const [messages, setMessages] = useState([\n       {\n           id: 1,\n           text: \"Welcome to Vyapar Sarthi! How can I help you today? Try saying: '10 Parle-G biscuit stock mein add karo'\",\n           sender: 'assistant',\n           timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\n       },\n   ]);\n\n\n   // State for the text input field\n   const [inputText, setInputText] = useState('');\n   // State to simulate recording state\n   const [isRecording, setIsRecording] = useState(false);\n   const [isLoading, setIsLoading] = useState(false);\n  \n   const conversationEndRef = useRef<HTMLDivElement>(null);\n\n\n   // Effect to scroll to the bottom of the conversation\n   useEffect(() => {\n       conversationEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n   }, [messages]);\n\n\n   // Function to add a new message to the conversation\n   const addMessage = (text: string, sender: 'user' | 'assistant') => {\n       const newMessage = {\n           id: messages.length + 1,\n           text,\n           sender,\n           timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\n       };\n       setMessages(prevMessages => [...prevMessages, newMessage]);\n       return newMessage;\n   };\n\n   // Function to handle backend processing and assistant reply\n   const processUserMessage = async (text: string) => {\n        setIsLoading(true);\n         const result = await handleVoiceCommand(text);\n        \n        let replyText = \"\";\n        if (result.error) {\n            replyText = `Sorry, I encountered an error: ${result.details || result.error}`;\n        } else {\n            switch(result.type) {\n                case 'ADD_STOCK':\n                    replyText = `Added ${result.data.quantity} of ${result.data.product_name} to stock.`;\n                    break;\n                case 'RECORD_SALE':\n                    replyText = `Recorded sale of ${result.data.quantity} ${result.data.product}. Amount â‚¹${result.data.amount}.`;\n                    break;\n                case 'ADD_CREDIT':\n                    replyText = `Added credit of â‚¹${result.data.amount} for ${result.data.party_name}.`;\n                    break;\n                case 'CHECK_BALANCE':\n                     replyText = `Checking balance for ${result.data.party_name}.`;\n                    break;\n                default:\n                    replyText = \"I've processed your request.\";\n            }\n        }\n        \n        addMessage(replyText, 'assistant');\n        setIsLoading(false);\n   }\n\n   // Handler for sending a text message\n   const handleSendMessage = async () => {\n       if (inputText.trim()) {\n           addMessage(inputText, 'user');\n           await processUserMessage(inputText);\n           setInputText('');\n       }\n   };\n\n   // Handler for the microphone button press\n   const handleMicPress = () => {\n       setIsRecording(true);\n       // This is where you would start the actual speech recognition.\n       // We will simulate a voice command after a delay.\n       setTimeout(() => {\n           setIsRecording(false);\n           const voiceCommands = [\n               \"20kg aashirvaad atta purchase mein daalo\",\n               \"Raju ko 50 rupaye udhaar diye\",\n               \"Aaj ka sales report dikhao\",\n               \"5 Dairy Milk Silk expire hone wali hai\"\n           ];\n           const randomCommand = voiceCommands[Math.floor(Math.random() * voiceCommands.length)];\n           addMessage(randomCommand, 'user');\n           processUserMessage(randomCommand);\n       }, 2500); // Simulate a 2.5 second recording\n   };\n  \n   // Handler for key press in input field\n   const handleKeyPress = (e: React.KeyboardEvent<HTMLInputElement>) => {\n       if (e.key === 'Enter') {\n           handleSendMessage();\n       }\n   };\n   \n    if (!clientLoaded) {\n        return null; // Or a loading spinner\n    }\n\n\n   return (\n       <div className=\"bg-background font-sans h-screen flex flex-col items-center\">\n           <Header />\n          \n           {/* Conversation Area */}\n           <main className=\"flex-1 w-full max-w-md mx-auto pt-24 pb-28 px-4 overflow-y-auto\">\n               <div className=\"flex flex-col space-y-4\">\n                   {messages.map(msg => (\n                       <MessageBubble key={msg.id} message={msg} />\n                   ))}\n                    {isLoading && (\n                        <MessageBubble message={{ text: \"...\", sender: 'assistant', timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) }} />\n                    )}\n                   <div ref={conversationEndRef} />\n               </div>\n           </main>\n\n\n           {/* Input Bar */}\n           <footer className=\"bg-card shadow-t-md w-full max-w-md mx-auto p-4 fixed bottom-0 left-0 right-0 z-10 rounded-t-lg\">\n               <div className=\"flex items-center space-x-3\">\n                   <input\n                       type=\"text\"\n                       value={inputText}\n                       onChange={(e) => setInputText(e.target.value)}\n                       onKeyPress={handleKeyPress}\n                       placeholder=\"Or type your command...\"\n                       className=\"flex-1 p-3 border border-border rounded-full focus:outline-none focus:ring-2 focus:ring-ring transition\"\n                       disabled={isLoading || isRecording}\n                   />\n                   {isRecording ? (\n                       <div className=\"flex items-center justify-center bg-red-500 text-white w-16 h-16 rounded-full transition-all duration-300 ease-in-out\">\n                            <svg className=\"w-8 h-8 animate-pulse\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z\"></path><path fillRule=\"evenodd\" d=\"M5.5 10.5a.5.5 0 01.5.5v1a4 4 0 004 4h.5a.5.5 0 010 1h-.5a5 5 0 01-5-5v-1a.5.5 0 01.5-.5z\" clipRule=\"evenodd\"></path></svg>\n                            <span className=\"absolute text-xs font-bold\">Listening...</span>\n                       </div>\n                   ) : (\n                       <button\n                           onClick={handleMicPress}\n                           disabled={isLoading}\n                           className=\"bg-primary hover:bg-primary/90 text-primary-foreground w-16 h-16 rounded-full flex items-center justify-center shadow-lg transform hover:scale-105 transition-all duration-300 ease-in-out disabled:opacity-50 disabled:scale-100\"\n                       >\n                           {/* Microphone Icon */}\n                           <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\"></path></svg>\n                       </button>\n                   )}\n               </div>\n           </footer>\n       </div>\n   );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}